<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>è¿å¥½è¿</title>
  <link rel="stylesheet" href="style.css">
  <script src="https://cdn.jsdelivr.net/npm/xlsx@0.18.5/dist/xlsx.full.min.js"></script>
</head>
<body>
<div class="container">
  <h1>ğŸ é©¬å¹´è¿å¥½è¿ ğŸ</h1>
  <input type="text" id="name" placeholder="è¯·è¾“å…¥å§“å" autocomplete="off">
  <button id="drawBtn">å¼€å§‹è¿å¥½è¿</button>

  <!-- æ»šåŠ¨åŠ¨ç”»åŒº -->
  <div class="roll-box" id="rollBox" style="display:none;">
    <div class="roll-text" id="rollText">å¥½è¿æ»šæ»šæ¥</div>
  </div>

  <div id="result" class="result"></div>
</div>

<script src="script.js"></script>
<script>
  loadBackground();
  const nameEl = document.getElementById("name");
  const drawBtn = document.getElementById("drawBtn");
  const resultEl = document.getElementById("result");
  const rollBox = document.getElementById("rollBox");
  const rollText = document.getElementById("rollText");

  drawBtn.addEventListener("click", () => {
    const name = nameEl.value.trim();
    if (!name) {
      resultEl.className = "result lose";
      resultEl.textContent = "è¯·è¾“å…¥å§“å";
      return;
    }

    // æ˜¾ç¤ºåŠ¨ç”»
    rollBox.style.display = "block";
    rollText.className = "roll-text";
    rollText.textContent = "å¥½è¿æ­£åœ¨æ´¾é€ä¸­...";
    resultEl.textContent = "";
    drawBtn.disabled = true;

    // åŠ¨ç”»æŒç»­1.5ç§’åæŠ½å¥–
    setTimeout(() => {
      const res = draw(name);
      rollText.className = "roll-text roll-stop";
      if (!res.ok) {
        resultEl.className = "result lose";
        resultEl.textContent = res.msg;
        rollText.textContent = "è¿å¥½è¿å¤±è´¥";
      } else {
        resultEl.className = "result win";
        if (res.isSpecial) {
          rollText.textContent = "ä¸€é©¬å½“å…ˆ";
          resultEl.textContent = `ã€${name}ã€‘æ­å–œè¿åˆ°ï¼šä¸€é©¬å½“å…ˆ`;
        } else {
          rollText.textContent = res.award;
          resultEl.textContent = `ã€${name}ã€‘æ­å–œè¿åˆ°ï¼š${res.award}`;
        }
      }
      drawBtn.disabled = false;
    }, 1500);
  });
</script>
</body>
</html>
